!function(d){"use strict";var n={init:function(){this.ovabrwSpecifications()},ovabrwSpecifications:function(){var i=d(document).find(".ovabrw-specifications");function a(){d(document).on("click",".popup-specification-close",function(i){i.preventDefault(),d(this).closest(".ovabrw-specifications").find(".ovabrw-popup-specification").hide(),d(this).closest(".ovabrw-specifications").find(".ovabrw-popup-specification-field").html("")})}0<d(document).find(".ovabrw-specifications .specification-sortable").length&&d(document).find(".ovabrw-specifications .specification-sortable").sortable({opacity:.6,start:function(i,e){d(document).find(".ovabrw-specifications .heading .ovabrw-loading").css("display","inline-block")},stop:function(i,e){var t,[a=null]=[d(document).find(".ovabrw-specifications .specification-sortable")];0<a.length&&(t=[],a.find('input[name="fields[]"]').each(function(){t.push(d(this).val())}),d.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_sort_specifications",security:ajax_object.security,fields:t},success:function(i){d(document).find(".ovabrw-specifications .heading .ovabrw-loading").hide()}}))}}),d(document).on("click",'.ovabrw-specifications button[value="add"]',function(){var e;d(this).closest(".ovabrw-specifications").find(".heading .ovabrw-loading").css("display","inline-block"),[e=null]=[d(this)],0<e.length&&d.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_add_specification",security:ajax_object.security},success:function(i){i&&(e.closest(".ovabrw-specifications").find(".ovabrw-popup-specification-field").html("").append(i),e.closest(".ovabrw-specifications").find(".ovabrw-popup-specification").fadeIn()),e.closest(".ovabrw-specifications").find(".heading .ovabrw-loading").hide(),a()}})}),i.find(".actions .dashicons-visibility").on("click",function(i){i.preventDefault();var[e=null]=[d(this)];0<e.length&&(e.closest(".actions").find(".ovabrw-loading").css("display","inline-block"),i=e.closest("tr").find('input[name="fields[]"]').val(),d.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_disable_specification",security:ajax_object.security,name:i},success:function(i){i&&(e.removeClass("active"),e.closest(".actions").find(".dashicons-hidden").addClass("active"),e.closest("tr").addClass("disabled"),e.closest("tr").find("td.enable span").hide()),e.closest(".actions").find(".ovabrw-loading").hide()}}))}),i.find(".actions .dashicons-hidden").on("click",function(i){i.preventDefault();var[e=null]=[d(this)];0<e.length&&(e.closest(".actions").find(".ovabrw-loading").css("display","inline-block"),i=e.closest("tr").find('input[name="fields[]"]').val(),d.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_enable_specification",security:ajax_object.security,name:i},success:function(i){i&&(e.removeClass("active"),e.closest(".actions").find(".dashicons-visibility").addClass("active"),e.closest("tr").removeClass("disabled"),e.closest("tr").find("td.enable span").show()),e.closest(".actions").find(".ovabrw-loading").hide()}}))}),i.find(".actions .dashicons-trash").on("click",function(i){i.preventDefault();var[e=null]=[d(this)];0<e.length&&(e.closest(".actions").find(".ovabrw-loading").css("display","inline-block"),i=e.closest("tr").find('input[name="fields[]"]').val(),d.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_delete_specification",security:ajax_object.security,name:i},success:function(i){i&&e.closest("tr").remove()}}))}),i.find(".actions .dashicons-edit").on("click",function(i){i.preventDefault();var e,[t=null]=[d(this)];0<t.length&&(t.closest(".ovabrw-specifications").find(".heading .ovabrw-loading").css("display","inline-block"),e=t.closest("tr").find('input[name="type"]').val(),i=t.closest("tr").find('input[name="fields[]"]').val(),d.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_edit_specification",security:ajax_object.security,name:i,type:e},success:function(i){i&&(t.closest(".ovabrw-specifications").find(".ovabrw-popup-specification-field").html("").append(i),t.closest(".ovabrw-specifications").find(".ovabrw-popup-specification").fadeIn(),"date"==e)&&n.datepicker(),d(document).find(".heading .ovabrw-loading").hide(),d(document).find(".specification-options .option-sortable").sortable({opacity:.6}),a()}}))}),d(document).on("change",'.ovabrw-popup-specification select[name="type"]',function(){var e,[t=null]=[d(this)];0<t.length&&(t.closest(".ovabrw-specifications").find(".heading .ovabrw-loading").css("display","inline-block"),e=t.val(),d.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_change_type_specification",security:ajax_object.security,type:e},success:function(i){i&&(t.closest(".ovabrw-specifications").find(".ovabrw-popup-specification-field").html("").append(i),t.closest(".ovabrw-specifications").find(".ovabrw-popup-specification").fadeIn(),"date"==e)&&n.datepicker(),d(document).find(".heading .ovabrw-loading").hide(),d(document).find(".specification-options .option-sortable").sortable({opacity:.6}),a()}}))}),d(document).on("click",".specification-options .btn-add-new",function(i){i.preventDefault();i='<tr class="ui-sortable-handle">';i+='<td><input type="text" name="options[]" required></td>';d(this).closest("tbody").append('<tr class="ui-sortable-handle"><td><input type="text" name="options[]" required></td><td><span class="btn btn-add-new">+</span><span class="btn btn-add-remove">x</span><span class="dashicons dashicons-menu-alt3"></span></td></tr>')}),d(document).on("click",".specification-options .btn-add-remove",function(i){i.preventDefault(),d(this).closest("tr").remove()}),d(document).on("click",".specification-add-file",function(i){i.preventDefault();var e=d(this),t=wp.media.frames.fileFrame=wp.media({title:d(this).data("uploader-title"),button:{text:d(this).data("uploader-title")},states:[new wp.media.controller.Library({title:d(this).data("uploader-title"),filterable:"all",multiple:!1})]});t.on("select",function(){var i=t.state().get("selection").first().toJSON();i.id&&((0<e.closest("td").find("input.attachment-id").length?e.closest("td").find("input.attachment-id"):e.closest("td").find('input[name="default"]')).val(i.id),e.closest("td").find(".file-default a").attr("href",i.editLink),e.closest("td").find(".file-default a").text(i.filename),e.closest("td").find(".file-default").show())}),t.open()}),d(document).on("click",".ovabrw-specifications .file-default .btn",function(i){i.preventDefault(),(0<d(this).closest("td").find("input.attachment-id").length?d(this).closest("td").find("input.attachment-id"):d(this).closest("td").find('input[name="default"]')).val(""),d(this).closest(".file-default").hide()})},datepicker:function(){if("object"==typeof easepick){var a=(a=d(document).find('input[name="ovabrw-datepicker-options"]').val())?d.parseJSON(a):{};if(0<Object.keys(a).length){a.PresetPlugin.customPreset&&d.each(a.PresetPlugin.customPreset,function(t,i){d.isArray(i)&&d.each(i,function(i,e){a.PresetPlugin.customPreset[t][i]=new Date(e)})});var n=[],s=(a.disableWeekDays&&(n=a.disableWeekDays),[]),o=(a.disableDates&&(s=a.disableDates),[]),c=(a.bookedDates&&(o=a.bookedDates),[]),e=(a.allowedDates&&(c=a.allowedDates),"");switch(a.format){case"d-m-Y":e="DD-MM-YYYY";break;case"m/d/Y":e="MM/DD/YYYY";break;case"Y/m/d":e="YYYY/MM/DD";break;case"Y-m-d":e="YYYY-MM-DD";break;default:e="DD-MM-YYYY"}var l="";a.startDate&&(l=a.startDate),d(document).find(".ovabrw-datepicker").each(function(){var i,t=d(this);0==t.closest("tr").find(".easepick-wrapper").length&&(i=t.attr("id"),i=new easepick.create({element:"#"+i,css:a.css,firstDay:parseInt(a.firstDay),lang:a.lang,zIndex:parseInt(a.zIndex),grid:parseInt(a.grid),calendars:parseInt(a.calendars),format:e,readonly:a.readonly,header:a.header,autoApply:a.autoApply,AmpPlugin:a.AmpPlugin,locale:a.locale,LockPlugin:{minDate:a.LockPlugin.minDate,maxDate:a.LockPlugin.maxDate,minDays:a.LockPlugin.minDays,maxDays:a.LockPlugin.maxDays,selectForward:a.LockPlugin.selectForward,selectBackward:a.LockPlugin.selectBackward,presets:a.LockPlugin.presets,inseparable:a.LockPlugin.inseparable,filter(i,e){if(d.isArray(n)&&0<n.length){var t=i.getDay();if(-1!==d.inArray((t=0===t?7:t).toString(),n))return!0}return!!(d.isArray(s)&&0<s.length&&s.includes(i.format("DD-MM-YYYY")))||!!(d.isArray(o)&&0<o.length&&o.includes(i.format("DD-MM-YYYY")))||!(!(d.isArray(c)&&0<c.length)||c.includes(i.format("DD-MM-YYYY")))||void 0}},PresetPlugin:a.PresetPlugin,plugins:["AmpPlugin","LockPlugin","PresetPlugin"],setup(e){e.on("show",i=>{t.closest("td").find(".easepick-wrapper").css("visibility","visible")}),e.on("hide",i=>{t.closest("td").find(".easepick-wrapper").css("visibility","hidden")}),e.on("click",function(i){i.target.classList.contains("reset-button")&&(l?e.gotoDate(l):e.gotoDate(new Date))})}}),l)&&i.gotoDate(l)})}}}};d(document).ready(function(){n.init()})}(jQuery);