!function(h){"use strict";var b={init:function(){this.ovabrwSelect2(),this.datetimepicker(),this.viewCalendar(),this.getAvailableItems()},ovabrwSelect2:function(){"function"==typeof h.fn.select2&&h(".ovabrw-select2").select2({placeholder:h(this).data("placeholder"),allowClear:!0})},datetimepicker:function(){if("object"==typeof easepick){var n,u,g='<svg enable-background="new 0 0 512 512" viewBox="0 0 512 512" width="14" height="14" xmlns="http://www.w3.org/2000/svg"><g><path d="m256 0c-140.959 0-256 115.049-256 256 0 140.959 115.049 256 256 256 140.959 0 256-115.05 256-256 0-140.959-115.049-256-256-256zm0 482c-124.617 0-226-101.383-226-226s101.383-226 226-226 226 101.383 226 226-101.383 226-226 226z"></path><circle cx="128.721" cy="383.279" r="15"></circle><circle cx="383.279" cy="128.721" r="15"></circle><path d="m118.114 118.114c-5.858 5.858-5.858 15.355 0 21.213s15.355 5.858 21.213 0 5.858-15.355 0-21.213c-5.857-5.858-15.355-5.858-21.213 0z"></path><path d="m372.673 372.673c-5.858 5.858-5.858 15.355 0 21.213s15.355 5.858 21.213 0 5.858-15.355 0-21.213-15.356-5.858-21.213 0z"></path><path d="m256 121c8.284 0 15-6.716 15-15v-30c0-8.284-6.716-15-15-15s-15 6.716-15 15v30c0 8.284 6.716 15 15 15z"></path><path d="m256 391c-8.284 0-15 6.716-15 15v30c0 8.284 6.716 15 15 15s15-6.716 15-15v-30c0-8.284-6.716-15-15-15z"></path><path d="m121 256c0-8.284-6.716-15-15-15h-30c-8.284 0-15 6.716-15 15s6.716 15 15 15h30c8.284 0 15-6.716 15-15z"></path><path d="m391 256c0 8.284 6.716 15 15 15h30c8.284 0 15-6.716 15-15s-6.716-15-15-15h-30c-8.284 0-15 6.716-15 15z"></path><path d="m271 249.787v-83.787c0-8.284-6.716-15-15-15s-15 6.716-15 15v90c0 3.978 1.581 7.793 4.394 10.607l90 90c5.857 5.857 15.355 5.858 21.213 0s5.858-15.355 0-21.213z"></path></g></svg>',e=h(document).find('input[name="ovabrw-datetimepicker-options"]').val();if(e&&(e=h.parseJSON(e),n=e.datepicker,u=e.timepicker),0<Object.keys(n).length&&0<Object.keys(u).length){var f=u.defaultStartTime,v=u.defaultEndTime,i=(u.allowStartTimes,u.allowEndTimes,n.PresetPlugin&&n.PresetPlugin.customPreset&&h.each(n.PresetPlugin.customPreset,function(a,e){h.isArray(e)&&h.each(e,function(e,t){n.PresetPlugin.customPreset[a][e]=new Date(t)})}),[]),r=(n.disableWeekDays&&(i=n.disableWeekDays),[]),s=(n.disableDates&&(r=n.disableDates),[]),o=(n.bookedDates&&(s=n.bookedDates),[]),l=(n.allowedDates&&(o=n.allowedDates),"");switch(n.format){case"d-m-Y":l="DD-MM-YYYY";break;case"m/d/Y":l="MM/DD/YYYY";break;case"Y/m/d":l="YYYY/MM/DD";break;case"Y-m-d":l="YYYY-MM-DD";break;default:l="DD-MM-YYYY"}var a="";n.startDate&&(a=n.startDate),h(document).find(".ovabrw-datetimepicker.start-date").each(function(){var p=h(this),t=p.attr("id"),m=p.closest("form").find(".ovabrw-datetimepicker.end-date"),e="";e=(e=0<m.length?m.attr("id"):e)?new easepick.create({element:"#"+t,css:n.css,firstDay:parseInt(n.firstDay),lang:n.lang,zIndex:parseInt(n.zIndex),grid:parseInt(n.grid),calendars:parseInt(n.calendars),format:l,readonly:n.readonly,header:n.header,autoApply:n.autoApply,AmpPlugin:n.AmpPlugin,locale:n.locale,RangePlugin:{elementEnd:"#"+e,repick:n.RangePlugin.repick,strict:n.RangePlugin.strict,tooltip:n.RangePlugin.tooltip,locale:n.RangePlugin.locale},LockPlugin:{minDate:n.LockPlugin.minDate,maxDate:n.LockPlugin.maxDate,minDays:n.LockPlugin.minDays,maxDays:n.LockPlugin.maxDays,selectForward:n.LockPlugin.selectForward,selectBackward:n.LockPlugin.selectBackward,presets:n.LockPlugin.presets,inseparable:n.LockPlugin.inseparable,filter(e,t){if(h.isArray(i)&&0<i.length){var a=e.getDay();if(-1!==h.inArray((a=0===a?7:a).toString(),i))return!0}return!!(h.isArray(r)&&0<r.length&&r.includes(e.format("DD-MM-YYYY")))||!!(h.isArray(s)&&0<s.length&&s.includes(e.format("DD-MM-YYYY")))||!(!(h.isArray(o)&&0<o.length)||o.includes(e.format("DD-MM-YYYY")))||void 0}},PresetPlugin:n.PresetPlugin,plugins:n.plugins,setup(d){d.on("render",e=>{var t=e.detail["view"];if("Container"==t){const c=h(e.target);c.hasClass("show")&&(b.datePickerResponse(c,d),h(window).resize(function(){b.datePickerResponse(c,d)}));var a=(a=d.startDate)||p.attr("data-date"),t=d.startTime;t=(t=t||d.startTimeChanged)||p.attr("data-time"),a&&t&&p.val(a+" "+t);var n,i,r,s,o=(o=d.endDate)||m.attr("data-date"),l=d.endTime,e=(l=(l=l||d.endTimeChanged)||m.attr("data-time"),o&&l&&m.val(o+" "+l),e.target.querySelectorAll(".time-plugin-container"));"function"==typeof h.fn.timepicker&&e&&(i=(i='<div class="timepicker-wrap pickup-time">')+g+'<span class="timepicker-label">'+u.lang.pickUp+'</span><span class="ovabrw-timepicker start-time"></span></div>',s=(s='<div class="timepicker-wrap dropoff-time">')+g+'<span class="timepicker-label">'+u.lang.dropOff+'</span><span class="ovabrw-timepicker end-time"></span></div>',h(e).html(""),i&&h(e).append(i),s&&h(e).append(s),n=h(e).find(".ovabrw-timepicker.start-time"),(i=Object.assign({},u)).step=1,i.scrollSelect=t||f,n.timepicker(i),n.on("selectTime",function(){d.startTimeChanged=n.timepicker("getTimeString"),a&&o&&h(this).closest(".easepick-container").find("button.apply-button").prop("disabled",!1)}),r=h(e).find(".ovabrw-timepicker.end-time"),(s=Object.assign({},u)).step=1,s.scrollSelect=l||v,r.timepicker(s),r.on("selectTime",function(){d.endTimeChanged=r.timepicker("getTimeString"),a&&o&&h(this).closest(".easepick-container").find("button.apply-button").prop("disabled",!1)}))}}),d.on("show",e=>{d.currentInput=h(e.detail.target),d.calendarWrapper=h("#"+t).next(".easepick-wrapper");e=p.attr("data-date"),e&&(d.startDate=e),e=p.attr("data-time"),e&&(d.startTime=e),e=m.attr("data-date"),e&&(d.endDate=e),e=m.attr("data-time");e&&(d.endTime=e),d.renderAll()}),d.on("click",function(e){e.target.classList.contains("reset-button")&&(a?d.gotoDate(a):d.gotoDate(new Date),p.val(""),m.val(""),d.startDate="",d.endDate="",p.attr("data-date",""),m.attr("data-date",""),d.startTime="",d.endTime="",p.attr("data-time",""),m.attr("data-time",""),d.startTimeChanged="",d.endTimeChanged="",d.clear())}),d.on("select",e=>{var t,a=c(e.detail.start,l),a=(a&&(d.startDate=a,p.attr("data-date",a),(t=d.startTimeChanged)?(d.startTime=t,p.attr("data-time",d.startTime),d.startTimeChanged=""):d.startTime||(d.startTime=f,p.attr("data-time",d.startTime)),t=d.startTime,p.val(a+" "+t)),c(e.detail.end,l));a&&(d.endDate=a,m.attr("data-date",a),(t=d.endTimeChanged)?(d.endTime=t,m.attr("data-time",t),d.endTimeChanged=""):d.endTime||(d.endTime=v,m.attr("data-time",d.endTime)),e=d.endTime,m.val(a+" "+e))})}}):new easepick.create({element:"#"+t,css:n.css,firstDay:parseInt(n.firstDay),lang:n.lang,zIndex:parseInt(n.zIndex),grid:parseInt(n.grid),calendars:parseInt(n.calendars),format:l,readonly:n.readonly,header:n.header,autoApply:n.autoApply,AmpPlugin:n.AmpPlugin,locale:n.locale,LockPlugin:{minDate:n.LockPlugin.minDate,maxDate:n.LockPlugin.maxDate,minDays:n.LockPlugin.minDays,maxDays:n.LockPlugin.maxDays,selectForward:n.LockPlugin.selectForward,selectBackward:n.LockPlugin.selectBackward,presets:n.LockPlugin.presets,inseparable:n.LockPlugin.inseparable,filter(e,t){if(h.isArray(i)&&0<i.length){var a=e.getDay();if(-1!==h.inArray((a=0===a?7:a).toString(),i))return!0}return!!(h.isArray(r)&&0<r.length&&r.includes(e.format("DD-MM-YYYY")))||!!(h.isArray(s)&&0<s.length&&s.includes(e.format("DD-MM-YYYY")))||!(!(h.isArray(o)&&0<o.length)||o.includes(e.format("DD-MM-YYYY")))||void 0}},PresetPlugin:n.PresetPlugin,plugins:["AmpPlugin","LockPlugin","TimePlugin"],setup(r){r.on("render",e=>{var t,a,n,i=e.detail["view"];"Container"==i&&(t=(t=r.startDate)||p.attr("data-date"),i=(i=(i=r.startTime)||r.startTimeChanged)||p.attr("data-time"),t&&i&&p.val(t+" "+i),e=e.target.querySelectorAll(".time-plugin-container"),"function"==typeof h.fn.timepicker)&&e&&(n=(n='<div class="timepicker-wrap pickup-time">')+g+'<span class="timepicker-label">'+u.lang.pickUp+'</span><span class="ovabrw-timepicker start-time"></span></div>',h(e).html(""),n&&h(e).append(n),a=h(e).find(".ovabrw-timepicker.start-time"),(n=Object.assign({},u)).step=1,n.scrollSelect=i||f,a.timepicker(n),a.on("selectTime",function(){r.startTimeChanged=a.timepicker("getTimeString"),t&&h(this).closest(".easepick-container").find("button.apply-button").prop("disabled",!1)}))}),r.on("show",e=>{var t=p.attr("data-date"),t=(t&&(r.startDate=t),p.attr("data-time"));t&&(r.startTime=t),r.renderAll()}),r.on("click",function(e){e.target.classList.contains("reset-button")&&(a?r.gotoDate(a):r.gotoDate(new Date),p.val(""),r.startDate="",p.attr("data-date",""),r.startTime="",p.attr("data-time",""),r.startTimeChanged="",r.clear())}),r.on("select",e=>{var t,e=c(e.detail.date,l);e&&(r.startDate=e,p.attr("data-date",e),(t=r.startTimeChanged)?(r.startTime=t,p.attr("data-time",r.startTime),r.startTimeChanged=""):r.startTime||(r.startTime=f,p.attr("data-time",r.startTime)),t=r.startTime,p.val(e+" "+t))})}}),a&&e.gotoDate(a)})}}function c(e="",t="DD-MM-YYYY"){var a,n;return!(!e||([n=""]=[e],!n)||(n=new Date(n),isNaN(n.getTime())))&&(e=("0"+(n=new Date(e)).getDate()).slice(-2),a=("0"+(n.getMonth()+1)).slice(-2),n=n.getFullYear(),t.replace("DD",e).replace("MM",a).replace("YYYY",n))}},datePickerResponse:function(e=null,t=null){var a,n,i,r=h(window).width();480<r&&e&&t&&(a=t.currentInput,t=t.calendarWrapper,a)&&0<a.length&&t&&0<t.length&&(n=a.outerWidth(),i=a.outerHeight(),i=a.offset().top-t.offset().top+i,e.css("top",i),i=a.offset().left-t.offset().left,e.css("left",i),810<(t=r-a.offset().left)?e.find(".calendars").removeClass("grid-1").addClass("grid-2"):(e.find(".calendars").removeClass("grid-2").addClass("grid-1"),t<485&&e.css("left",-n)))},viewCalendar:function(){var e,t,a,r,n=document.getElementById("ovabrw-calendar");n&&(h(n).closest(".ovabrw-calendar-container").css({height:"auto",overflow:"auto"}),e=(e=h(document).find('input[name="ovabrw-calendar-options"]').val())&&h.parseJSON(e),t=[],(a=h(document).find('input[name="ovabrw-data-events"]').val())&&(t=JSON.parse(a)),(r=new FullCalendar.Calendar(n,wp.hooks.applyFilters("ovabrwBookingCalendar.options",{locale:e.lang,initialView:e.initialView,height:e.height,events:t,direction:"ltr",firstDay:e.firstDay,dayMaxEvents:e.dayMaxEvents,headerToolbar:{left:"title",right:"prev,next,today,dayGridMonth,timeGridWeek,timeGridDay,listWeek"},eventTimeFormat:e.eventTimeFormat,eventMouseEnter:function(e){var t=h(e.el),a=e.event.extendedProps.htmlEvent,n=e.view.type;0<t.length&&a&&(e=t.closest("#ovabrw-calendar"),e=t.offset().top-e.offset().top<e.height()/2?"bottom":"top",tippy.hideAll(),tippy(t[0],{content:'<span class="ovabrw-tippy">'+a+"</span>",animation:"scale",arrow:!0,interactive:!0,allowHTML:!0,followCursor:!0,placement:e,theme:"ovabrw-tippy-event",trigger:"mouseenter",zIndex:999999,duration:[500,0],onShow(e){"dayGridMonth"!=n&&(h(t).closest(".fc-day").addClass("ovabrw-fc-day"),h(t).closest(".fc-timegrid-event-harness").addClass("ovabrw-popup-info"))},onHide(e){"dayGridMonth"!=n&&(h(t).closest(".fc-day").removeClass("ovabrw-fc-day"),h(t).closest(".fc-timegrid-event-harness").removeClass("ovabrw-popup-info"))}}).show())}}),e)).render(),h(document).find(".ovabrw-booking-calendar-filter").on("submit",function(e){e.preventDefault();var t,a,n,e=h(this),i=e.find('select[name="pid"]').val();r&&((t=e.closest(".ovabrw-booking-calendar-wrap").find(".ovabrw-backbone-modal-backdrop")).show(),a=r.view.currentStart.getMonth()+1,n=r.view.currentStart.getFullYear(),r.removeAllEvents(),h.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_booking_calendar_get_events",product_id:i,current_month:a,current_year:n,security:ajax_object.security},success:function(e){e&&(e=h.parseJSON(e)).events&&r.addEventSource(e.events),t.hide()}})),e.find('input[name="filter"]').blur()}),h(document).find(".ovabrw-booking-calendar-wrap button.fc-today-button, .ovabrw-booking-calendar-wrap button.fc-prev-button, .ovabrw-booking-calendar-wrap button.fc-next-button").on("click",function(){var t=h(this).closest(".ovabrw-booking-calendar-wrap").find(".ovabrw-backbone-modal-backdrop"),e=(t.show(),h(this).closest(".ovabrw-booking-calendar-wrap").find('.ovabrw-booking-calendar-filter select[name="pid"]').val()),a=r.view.currentStart.getMonth()+1,n=r.view.currentStart.getFullYear();r.removeAllEvents(),h.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_booking_calendar_get_events",product_id:e,current_month:a,current_year:n,security:ajax_object.security},success:function(e){e&&(e=h.parseJSON(e)).events&&r.addEventSource(e.events),t.hide()}})}))},getAvailableItems:function(){h(document).find(".ovabrw-booking-items-available").on("submit",function(e){e.preventDefault();var t=h(this);if(!function(e=null){{var t,a;e&&0<e.length&&("undefined"!=typeof ovabrwErrorMessages&&(t=ovabrwErrorMessages),a=!0,e.find(".ovabrw-input-required").each(function(){if(!h(this).val())return b.popupError(h(this),t.required),a=!1}))}return a}(t))return!1;var a=t.find("span.dashicons-update-alt"),e=(a.show(),t.find('select[name="pid"]').val()),n=t.find('select[name="pickup_location"]').val(),i=t.find('select[name="dropoff_location"]').val(),r=t.find('input[name="from_date"]').val(),s=t.find('input[name="to_date"]').val();h.ajax({url:ajax_object.ajax_url,type:"POST",data:{action:"ovabrw_booking_calendar_get_available_items",product_id:e,pickup_location:n,dropoff_location:i,pickup_date:r,dropoff_date:s,security:ajax_object.security},success:function(e){e&&t.find(".items-available").html("").append(e),a.hide()}}),t.find('input[name="filter"]').blur()})},popupError:function(t=null,a="",e=!0){if(t&&0<t.length)if(e){e=t.val();t.val(""),t.val(e).focus();const n=tippy(t[0],{trigger:"manual",content:'<span class="ovabrw-tippy">'+a+"</span>",animation:"scale",allowHTML:!0,arrow:!0,zIndex:999999});n.show(),setTimeout(function(){n.destroy()},5e3)}else h("html, body").animate({scrollTop:t.offset().top-h(window).height()/2},500,function(){const e=tippy(t[0],{trigger:"manual",content:'<span class="ovabrw-tippy">'+a+"</span>",animation:"scale",allowHTML:!0,arrow:!0,zIndex:999999});e.show(),setTimeout(function(){e.destroy()},5e3)})}};h(document).ready(function(){b.init()})}(jQuery);